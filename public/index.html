<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>So8å…­ä»£å£°å¡ SKGè°ƒéŸ³å° å‚æ•°å®šåˆ¶å·¥å…·ï¼ˆVercelç‰ˆï¼‰</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: "å¾®è½¯é›…é»‘", sans-serif;
        }
        body {
            background: #f5f7fa;
            padding: 20px;
            max-width: 1000px;
            margin: 0 auto;
        }
        .container {
            background: white;
            border-radius: 10px;
            padding: 30px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            margin-bottom: 20px;
        }
        h1 {
            color: #2c3e50;
            text-align: center;
            margin-bottom: 30px;
            font-size: 24px;
        }
        h2 {
            color: #34495e;
            font-size: 18px;
            margin: 20px 0 10px;
            padding-bottom: 5px;
            border-bottom: 2px solid #3498db;
        }
        .form-group {
            margin-bottom: 15px;
        }
        label {
            display: block;
            margin-bottom: 5px;
            color: #555;
            font-weight: 500;
        }
        input, select, textarea {
            width: 100%;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 5px;
            font-size: 14px;
            outline: none;
            transition: border 0.3s;
        }
        input:focus, select:focus, textarea:focus {
            border-color: #3498db;
        }
        input[type="file"] {
            padding: 3px;
        }
        button {
            background: #3498db;
            color: white;
            border: none;
            padding: 12px 30px;
            border-radius: 5px;
            font-size: 16px;
            cursor: pointer;
            margin-top: 20px;
            transition: background 0.3s;
        }
        button:hover {
            background: #2980b9;
        }
        .result-area {
            background: #f8f9fa;
            border: 1px solid #eee;
            border-radius: 5px;
            padding: 20px;
            margin-top: 20px;
            display: none;
        }
        .result-area h3 {
            color: #2c3e50;
            margin-bottom: 15px;
            font-size: 16px;
        }
        .param-item {
            margin-bottom: 10px;
            line-height: 1.8;
        }
        .param-title {
            font-weight: bold;
            color: #3498db;
        }
        .tips {
            color: #e74c3c;
            font-size: 12px;
            margin-top: 5px;
        }
        .audio-analysis {
            background: #e8f4fd;
            padding: 10px;
            border-radius: 5px;
            margin: 15px 0;
            font-size: 13px;
            color: #2c3e50;
            display: none;
        }
        .loading {
            color: #3498db;
            margin-top: 10px;
            display: none;
        }
        .error {
            color: #e74c3c;
            margin-top: 10px;
            display: none;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>So8å…­ä»£å£°å¡ SKGè°ƒéŸ³å° ä¸“å±å‚æ•°å®šåˆ¶ï¼ˆVercelç‰ˆï¼‰</h1>
        
        <!-- è®¾å¤‡ä¿¡æ¯ -->
        <h2>ä¸€ã€è®¾å¤‡ä¿¡æ¯ï¼ˆå¿…å¡«ï¼‰</h2>
        <div class="form-group">
            <label for="mic-model">è¯ç­’å‹å·+ç±»å‹ï¼ˆå¦‚ï¼šæ°‘æ­ŒMG205 åŠ¨åœˆè¯ç­’ï¼‰</label>
            <input type="text" id="mic-model" placeholder="è¯·è¾“å…¥è¯ç­’å‹å·å’Œç±»å‹ï¼Œä¾‹ï¼šèˆ’å°”SM58 åŠ¨åœˆè¯ç­’" required>
        </div>
        <div class="form-group">
            <label for="headset-model">ç›‘å¬è€³æœºå‹å·</label>
            <input type="text" id="headset-model" placeholder="ä¾‹ï¼šæ£®æµ·å¡å°”HD201 å¤´æˆ´å¼è€³æœº">
        </div>
        <div class="form-group">
            <label for="phone-system">æ‰‹æœºç³»ç»Ÿ</label>
            <select id="phone-system" required>
                <option value="">è¯·é€‰æ‹©</option>
                <option value="android">å®‰å“</option>
                <option value="ios">è‹¹æœ</option>
            </select>
        </div>

        <!-- ä½¿ç”¨åœºæ™¯ -->
        <h2>äºŒã€ä½¿ç”¨åœºæ™¯ï¼ˆå¿…å¡«ï¼‰</h2>
        <div class="form-group">
            <label for="usage">æ ¸å¿ƒç”¨é€”</label>
            <select id="usage" required>
                <option value="">è¯·é€‰æ‹©</option>
                <option value="sing-live">ç›´æ’­å”±æ­Œ</option>
                <option value="chat">è¯­éŸ³èŠå¤©</option>
                <option value="audio-book">æœ‰å£°å°è¯´</option>
                <option value="video-record">çŸ­è§†é¢‘å½•éŸ³</option>
            </select>
        </div>
        <div class="form-group">
            <label for="song-style">å¸¸å”±æ­Œæ›²é£æ ¼ï¼ˆå¯å¤šé€‰ï¼Œç”¨é€—å·åˆ†éš”ï¼‰</label>
            <input type="text" id="song-style" placeholder="ä¾‹ï¼šæ…¢æ­Œ,æ°‘è°£,rap" required>
        </div>
        <div class="form-group">
            <label for="noise-level">ç¯å¢ƒå™ªéŸ³æƒ…å†µ</label>
            <select id="noise-level" required>
                <option value="">è¯·é€‰æ‹©</option>
                <option value="quiet">å®‰é™å§å®¤ï¼ˆæ— æ˜æ˜¾å™ªéŸ³ï¼‰</option>
                <option value="slight">è½»å¾®ç¯å¢ƒéŸ³ï¼ˆå¦‚ç©ºè°ƒå£°ï¼‰</option>
                <option value="loud">å™ªéŸ³è¾ƒæ˜æ˜¾ï¼ˆå¦‚çª—å¤–è½¦æµ/äººå£°ï¼‰</option>
            </select>
        </div>

        <!-- å£°çº¿ç‰¹ç‚¹ -->
        <h2>ä¸‰ã€å£°çº¿ç‰¹ç‚¹ï¼ˆé€‰å¡«ï¼Œç²¾å‡†åº¦æ›´é«˜ï¼‰</h2>
        <div class="form-group">
            <label for="voice-type">å£°çº¿ç±»å‹</label>
            <select id="voice-type">
                <option value="">è¯·é€‰æ‹©</option>
                <option value="thin">åç»†</option>
                <option value="thick">åæµ‘åš</option>
                <option value="high">åé«˜éŸ³</option>
                <option value="low">åä½éŸ³</option>
            </select>
        </div>
        <div class="form-group">
            <label for="voice-problem">å¸¸è§é—®é¢˜</label>
            <textarea id="voice-problem" rows="2" placeholder="ä¾‹ï¼šæœ‰é¼»éŸ³ã€å£°éŸ³å‘é—·ã€é«˜é¢‘åˆºè€³ã€å°å£°å”±æ­Œæ˜“æ–­éŸ³"></textarea>
        </div>

        <!-- éŸ³é¢‘ä¸Šä¼  -->
        <h2>å››ã€éŸ³é¢‘æ ·æœ¬ï¼ˆå»ºè®®ä¸Šä¼ ï¼‰</h2>
<!-- éŸ³é¢‘ä¸Šä¼ éƒ¨åˆ†ä¿®æ”¹ -->
<div class="form-group">
    <label for="audio-file">ä¸Šä¼ éŸ³é¢‘ï¼ˆ30-60ç§’ï¼ŒMP3/WAVæ ¼å¼ï¼‰</label>
    <input type="file" id="audio-file" accept=".mp3,.wav">
    <p class="tips">éŸ³é¢‘è¦æ±‚ï¼šâ‰¤5MBï¼Œå‰10ç§’å½•ç¯å¢ƒå™ªéŸ³ï¼Œä¸­é—´20ç§’æ­£å¸¸è¯´è¯ï¼Œæœ€å10ç§’å”±1å¥æ­Œæ›²ç‰‡æ®µï¼ˆç”¨æ—¥å¸¸éŸ³é‡ï¼‰</p>
</div>

        <!-- çŠ¶æ€æç¤º -->
        <div class="loading" id="loading">æ­£åœ¨è§£æéŸ³é¢‘å¹¶ç”Ÿæˆå‚æ•°ï¼Œè¯·ç¨å€™...</div>
        <div class="error" id="error"></div>
        
        <!-- éŸ³é¢‘åˆ†æç»“æœ -->
        <div class="audio-analysis" id="audio-analysis"></div>

        <!-- æäº¤æŒ‰é’® -->
        <button id="generate-btn">ç”Ÿæˆä¸“å±è°ƒèŠ‚å‚æ•°</button>

        <!-- å‚æ•°ç»“æœå±•ç¤º -->
        <div class="result-area" id="result-area">
            <h3>âœ… ä½ çš„So8å…­ä»£å£°å¡ SKGè°ƒéŸ³å°ä¸“å±å‚æ•°</h3>
            <div class="param-item">
                <span class="param-title">1. åŸºç¡€æ—‹é’®ï¼š</span>
                <span id="basic-knobs"></span>
            </div>
            <div class="param-item">
                <span class="param-title">2. é™å™ªé˜ˆå€¼ï¼š</span>
                <span id="noise-reduction"></span>
            </div>
            <div class="param-item">
                <span class="param-title">3. å‡è¡¡å™¨ï¼ˆä¸“ä¸šæ¨¡å¼ï¼Œbellæ›²çº¿ï¼‰ï¼š</span>
                <span id="eq-params"></span>
            </div>
            <div class="param-item">
                <span class="param-title">4. å‹ç¼©å™¨ï¼š</span>
                <span id="compressor-params"></span>
            </div>
            <div class="param-item">
                <span class="param-title">5. æ··å“ï¼š</span>
                <span id="reverb-params"></span>
            </div>
            <div class="param-item">
                <span class="param-title">6. ä¼˜åŒ–å»ºè®®ï¼š</span>
                <span id="optimize-tips"></span>
            </div>
        </div>
    </div>

    <script>
        // Vercel APIè·¯å¾„ï¼ˆè‡ªåŠ¨é€‚é…å½“å‰åŸŸåï¼‰
        const API_URL = "/api/generate_params";

        // ç›‘å¬æäº¤æŒ‰é’®ç‚¹å‡»
        document.getElementById('generate-btn').addEventListener('click', async function() {
            // é‡ç½®çŠ¶æ€
            document.getElementById('loading').style.display = 'block';
            document.getElementById('error').style.display = 'none';
            document.getElementById('audio-analysis').style.display = 'none';
            document.getElementById('result-area').style.display = 'none';

            // è¡¨å•éªŒè¯
            const requiredFields = [
                document.getElementById('mic-model'),
                document.getElementById('phone-system'),
                document.getElementById('usage'),
                document.getElementById('song-style'),
                document.getElementById('noise-level')
            ];
            for (const field of requiredFields) {
                if (!field.value.trim()) {
                    document.getElementById('error').textContent = `è¯·å¡«å†™å¿…å¡«é¡¹ï¼š${field.previousElementSibling.textContent}`;
                    document.getElementById('error').style.display = 'block';
                    document.getElementById('loading').style.display = 'none';
                    return;
                }
            }

            // æ„å»ºè¡¨å•æ•°æ®
            const formData = new FormData();
            formData.append('mic_model', document.getElementById('mic-model').value.trim());
            formData.append('phone_system', document.getElementById('phone-system').value);
            formData.append('usage', document.getElementById('usage').value);
            formData.append('song_style', document.getElementById('song-style').value.trim());
            formData.append('noise_level', document.getElementById('noise-level').value);
            formData.append('voice_type', document.getElementById('voice-type').value);
            formData.append('voice_problem', document.getElementById('voice-problem').value.trim());
            
            // æ·»åŠ éŸ³é¢‘æ–‡ä»¶
            const audioFile = document.getElementById('audio-file').files[0];
            if (audioFile) {
                // é™åˆ¶æ–‡ä»¶å¤§å°ï¼ˆVercelå…è´¹ç‰ˆå•æ–‡ä»¶æœ€å¤§5MBï¼‰
                if (audioFile.size > 5 * 1024 * 1024) {
                    document.getElementById('error').textContent = "éŸ³é¢‘æ–‡ä»¶å¤§å°ä¸èƒ½è¶…è¿‡5MBï¼Œè¯·å‹ç¼©åä¸Šä¼ ï¼";
                    document.getElementById('error').style.display = 'block';
                    document.getElementById('loading').style.display = 'none';
                    return;
                }
                formData.append('audio_file', audioFile);
            }

            try {
                // è°ƒç”¨Vercel API
                const response = await fetch(API_URL, {
                    method: 'POST',
                    body: formData
                });

                const resData = await response.json();
                if (resData.code === 200) {
                    // æ˜¾ç¤ºéŸ³é¢‘åˆ†æç»“æœ
                    if (resData.audio_features && resData.audio_features.success) {
                        const af = resData.audio_features;
                        document.getElementById('audio-analysis').innerHTML = `
                            ğŸµ éŸ³é¢‘æ·±åº¦è§£æç»“æœï¼š<br>
                            - éŸ³é¢‘æ—¶é•¿ï¼š${af.duration.toFixed(1)}ç§’<br>
                            - å™ªéŸ³èƒ½é‡ï¼š${(af.noise_energy * 100).toFixed(2)}%ï¼ˆå€¼è¶Šé«˜å™ªéŸ³è¶Šå¤§ï¼‰<br>
                            - äººå£°å¹³å‡éŸ³é‡ï¼š${af.voice_avg_volume.toFixed(1)}dB<br>
                            - äººå£°å³°å€¼éŸ³é‡ï¼š${af.voice_peak_volume.toFixed(1)}dB<br>
                            - äººå£°åŠ¨æ€èŒƒå›´ï¼š${af.voice_dynamic_range.toFixed(1)}dB<br>
                            - äººå£°é«˜é¢‘èƒ½é‡ï¼š${(af.high_freq_energy + 80).toFixed(2)}%ï¼ˆç›¸å¯¹å€¼ï¼‰<br>
                            - äººå£°å¹³å‡åŸºé¢‘ï¼š${af.f0_mean.toFixed(0)}Hzï¼ˆå€¼è¶Šé«˜éŸ³è¶Šé«˜ï¼‰
                        `;
                        document.getElementById('audio-analysis').style.display = 'block';
                    }

                    // æ¸²æŸ“å‚æ•°
                    document.getElementById('basic-knobs').textContent = resData.params.basic_knobs;
                    document.getElementById('noise-reduction').textContent = resData.params.noise_reduction;
                    document.getElementById('eq-params').textContent = resData.params.eq_params;
                    document.getElementById('compressor-params').textContent = resData.params.compressor_params;
                    document.getElementById('reverb-params').textContent = resData.params.reverb_params;
                    document.getElementById('optimize-tips').textContent = resData.params.optimize_tips;

                    // æ˜¾ç¤ºç»“æœ
                    document.getElementById('result-area').style.display = 'block';
                    document.getElementById('result-area').scrollIntoView({ behavior: 'smooth' });
                } else {
                    throw new Error(resData.msg || "å‚æ•°ç”Ÿæˆå¤±è´¥");
                }
            } catch (e) {
                document.getElementById('error').textContent = `é”™è¯¯ï¼š${e.message}`;
                document.getElementById('error').style.display = 'block';
            } finally {
                document.getElementById('loading').style.display = 'none';
            }
        });
    </script>
</body>

</html>

